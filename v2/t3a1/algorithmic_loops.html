<html>

<head>
<meta charset="UTF-8">
<meta name="Author" content="John Whitehouse">
<meta name="KeyWords" content="Collatz 3x+1">

<TITLE> 3x+1 (Finding Loops Algorithmically) </TITLE>

<link rel="apple-touch-icon" href="http://www.eddaardvark.co.uk/favicon.png" />
<link rel="shortcut icon" href="http://www.eddaardvark.co.uk/favicon.png" />
<link rel="StyleSheet" href="http://www.eddaardvark.co.uk/jw.css" type="text/css" media="screen">
<script src="http://www.eddaardvark.co.uk/john.js"> </script>
<script src="../js_library/misc.js"> </script>
<script src="../js_library/tables.js"> </script>
<script src="t3a1.js"> </script>

<style>

TABLE.t1  { border-collapse: collapse; }
TABLE     { border-collapse: collapse; }

TD
    {    
        padding: 3pt 6pt;
        border: solid 1px coral;
    }


TD.v11    { font-family:        Courier;
            font-size:          small;
            text-align:         right;
            background:         DarkGray;
            border:             solid 1px red;
            margin:             0;
          }
TD.v12    { font-family:        Courier;
            font-size:          small;
            text-align:         right;
            background:         DarkGray;
            border:             solid 1px red;
            margin:             0;
          }
TD.v21    { font-family:        Courier;
            font-size:          small;
            text-align:         right;
            background:         DarkGray;
            border:             solid 1px red;
            margin:             0;
          }
TD.v22    { font-family:        Courier;
            font-size:          small;
            text-align:         right;
            background:         LightGray;
            border:             solid 1px red;
            margin:             0;
          }

TD.vzero  { font-family:        Courier;
            font-size:          small;
            text-align:         right;
            background:         White;
            border:             solid 1px red;
            margin:             0;
          }

TH.h1     { font-family:      Courier;
            font-weight:      bold;
            text-align:       center;
            background:       SteelBlue;
            border:           solid 1px red;
            margin:           0;
          }

TH.h2     { font-family:      Courier;
            font-weight:      bold;
            text-align:       center;
            background:       LightSteelBlue;
            border:           solid 1px red;
            margin:           0;
          }
</style>

<script>

OnStart = function ()
{
    var all = document.getElementsByClassName("expr");

    for (var i = 0; i < all.length; i++)
    {
        Misc.expand_element (all[i]);
    }

    MakeRemainderTable(mod_table, result1, result2);  
}

</script>
</head>

<body onload="OnStart();">

<!-- Banner -->

  <div style="margin: auto; width: 1024px;">
     <button style="width: 200px;" class="banner clickable" onclick="Show('http://www.eddaardvark.co.uk')">•
        <img border="0" src="http://www.eddaardvark.co.uk/images/home.png" title="Home Page" alt="Home Page">
        <br><strong>Home page</strong>
     </button>

     <button class="banner clickable" onclick="Show(T3A1.INDEX)">

        <p style="max-width: 420px;" >
            <img src="http://www.eddaardvark.co.uk/images/3x1_icon.png" alt="Banner Picture" title="3x+1 Pages"></h1>
        </p><p style="max-width: 420px;" >
             Finding Loops Algorithmically
        </p>

     </button>

     <!-- Ads -->

      <button style="width: 260px;" class="banner">
        <script type="text/javascript"><!--
          google_ad_client = "ca-pub-3534237235440125";
          /* Small Square */
          google_ad_slot = "0024655068";
          google_ad_width = 200;
          google_ad_height = 200;
          //-->
        </script>
        <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
        </script>
        <br><strong>Advertisement</strong>
     </button>
    </div>

<!-- Main content -->

    <div class="float w10 box in2" style="overflow: auto;">

<h2>Contents</h2>

<div class="in2">
<ul>
  <li><a href="#Introduction">Introduction</a></li>
  <li><a href="#ncycles">n&minus;Cycles</a></li>
  <li><a href="#3xk">Loops in 3x + K</a></li>

  <li><a href="#others">Other Pages</a></li>
</ul>
</div>

</div>

<!-- Introduction -->

<div class="float w10 box in2" style="overflow: auto;">

<h2><a name="Introduction">Introduction</a></h2>


<p>We can search for loops by deriving a single equation that combines a number of
iterations, f(x), and then solve it for being equal to the original number: <span class="expr">f(x)=x</span>. For the
unmodified sequence this is tricky as the equation has an 'if' condition in it, but if we
just focus on the odd sequence it becomes clearer.</p>


<h3>1&minus;cycles</h3>

<p>
    The next-odd iterator maps <span class="expr">x&rarr;(3x+1)/2^[a1], where 'a¬1' is an integer (>0)</span>.
</p><p>
    If we can find an odd integer solution to <span class="expr">(3x+1)/2^[a1]=x</span> we will have
    a loop that contains a single odd number and <span class="expr">'a¬1'</span> even ones. This expression rearranges to
    <span class="expr">(2^[a1]-3)*x=1</span>.
    The only positive integer factorisation of 1 is <span class="expr">1*1</span>, so both
    x and <span class="expr">(2^[a1]-3)</span> must be 1. The second condition leads
    to <span class="expr">a¬1=2</span>. The corresponding loop is [1,4,2,1], with 2 even and one odd members. This is the only possible loop with one odd member.
</p><p>
    If we relax the positive integer requirement we get a second solution where <span class="expr">a¬1=1 and x=&minus;1</span>.
    This is a loop with one odd and one even member [-1,-2,-1].
</p>
    
    
<h3>2&minus;cycles</h3>

<p>
    For 2&minus;cycles the equation to solve is <span class="expr">f(x)=(9x+2^[a1]+3)/2^[(a1+a2)]=x (where 'a¬1 and 'a¬2'</span> are integers greater than 0).
    
</p><p>

    This can be rearranged to <span class="expr">x=(2^[a1]+3)/(2^[(a1+a2)]-9)</span>. To solve this we
    need to find integral values of <span class="expr">a¬1 and a¬2 so that (2^[a1]+3) is an integer multiple of (2^[(a1+a2)]-9)</span>.
    The following table contains the calculations for some small values of a1 and a2 and shows that there are 4 solutions.
</p><p>

 <table>
  <tr>
   <td class="heading"> a1 </td> <td class="heading"> a2 </td> <td class="heading"> 2<sup>a1</sup>+3 </td> <td class="heading"> 2<sup>(a1+a2)</sup>&minus;9 </td> <td class="heading"> x </td>
  </tr>
  <tr>
   <td class="number"> 1 </td> <td class="number"> 1 </td> <td class="number"> 5 </td> <td class="number"> &minus;5 </td> <td class="number" id="green"> &minus;1 </td>
  </tr>
  <tr>
   <td class="number"> 1 </td> <td class="number"> 2 </td> <td class="number"> 5 </td> <td class="number"> &minus;1 </td> <td class="number" id="green"> &minus;5 </td>
  </tr>
  <tr>
   <td class="number"> 1 </td> <td class="number"> 3 </td> <td class="number"> 5 </td> <td class="number"> 7 </td> <td class="number"> 5/7 </td>
  </tr>
  <tr>
   <td class="number"> 2 </td> <td class="number"> 1 </td> <td class="number"> 7 </td> <td class="number"> &minus;1 </td> <td class="number" id="green"> &minus;7 </td>
  </tr>
  <tr>
   <td class="number"> 2 </td> <td class="number"> 2 </td> <td class="number"> 7 </td> <td class="number"> 7 </td> <td class="number" id="green"> 1 </td>
  </tr>
  <tr>
   <td class="number"> 2 </td> <td class="number"> 3 </td> <td class="number"> 7 </td> <td class="number"> 23 </td> <td class="number"> 7/23 </td>
  </tr>
  <tr>
   <td class="number"> 3 </td> <td class="number"> 1 </td> <td class="number"> 11 </td> <td class="number"> 7 </td> <td class="number"> 11/7 </td>
  </tr>
  <tr>
   <td class="number"> 3 </td> <td class="number"> 2 </td> <td class="number"> 11 </td> <td class="number"> 23 </td> <td class="number"> 11/23 </td>
  </tr>
  <tr>
   <td class="number"> 4 </td> <td class="number"> 1 </td> <td class="number"> 19 </td> <td class="number"> 23 </td> <td class="number"> 19/23 </td>
  </tr>
 </table>


</p><p>

    Two of these solutions (&minus;1 and 1) are repeats of the solutions we already found among the for 1&minus;cycles,
    leaving only &minus;5 and &minus;7, which turn out to be  two halves of the same solution,
    [&minus;5, &minus;14, &minus;7, &minus;20, &minus;10, &minus;5].
    This cycle contains <span class="expr">a¬1+a¬2=3</span> even numbers.

</p><p>
    There are no solutions for larger 'a' values as the potential values of x are already less then one, and become
    even smaller as the 'a' values increase.
</p><p>
    As we move to larger cycles we will always see that setting all the 'a' values to 1 will lead to x&nbsp;=&nbsp;&minus;1
    and setting them all to 2 will produce x&nbsp;=&nbsp;1.
</p>

    </div>

<!-- ################## N-Cycles ###################### -->


<div class="float w10 box in2" style="overflow: auto;">

<h2><a name="ncycles">n&minus;Cycles</a></h2>

<p>
    For larger cycles we can calculate a series of equations of the form <span class="expr">K*x=S</span>, where:
</p><p>

    <pre class="code expr">K=2^[(a1+a2+&hellip;+an)]-3^n
S=3^[n-1]+3^[(n-2)]*2^[a1]+3^[(n-3)]*2^[(a1+a2)]+&hellip;+3^0*2^[(a1+a2+&hellip;+a(n-1))]</pre>

</p><p>
    The 'a' values are the number of even numbers between successive odd values in the loop.
    We can define 'm' as the number of even values in the loop, giving
</p><p>

    <pre class="code expr">m=a¬1+a¬2+&hellip;+a¬n
K=2^m-3^n</pre>

</p><p>
    We can do a quick search for solutions when n is 3 by constructing a table similar to the one we wrote
    for n&nbsp;=&nbsp;2 in the previous section. This table, even for small a values is quite long, so I've
    reproduced it on a <a href="three_cycle_table.html"> separate page</a> for 'a' values up to m&nbsp;=&nbsp;8. The only
    integer solutions are the ones we've found already, &minus;1 and 1.
</p><p>
    For positive solutions we can reject values where K is negative, which shows that any loops will always have more
    even values than odd ones, in fact <span class="expr">m>n*log(3)/log(2).
    log(3)/log(2)</span> is just under 1.585, so there will be at least 58% more even values than odd ones.
</p>

</div>

<!-- ################## Loops in 3x+k ###################### -->

<div class="float w10 box in2" style="overflow: auto;">

<h2><a name="3xk"> Loops in 3x+k </a></h2>

<p>
    First, let us define the sets:
    
</p><p>

    <pre class=" code expr">A¬1=[a¬1,a¬2,&hellip;,a¬n],
A¬2=[a¬2,&hellip;,a¬n,a¬1],
A¬3=[a¬3,&hellip;,a¬n,a¬1,a¬2],
etc.</pre>

</p><p>

    Where <span class="expr">A¬[(i+1)]</span> is obtained by rotating the values in <span class="expr">A¬i</span> one place to the left. The resulting set of sets
    <span class="expr">[A¬1,&nbsp;A¬2,&nbsp;&hellip;]</span> has n members, as <span class="expr">A¬[(n+1)] is the same as A¬1</span>.

</p><p>

    We can then define the set of S-values <span class="expr">[s¬1, s¬2, &hellip;]=[S(A¬1), S(A¬2), &hellip;], where S(A¬i)</span> is the 
    value obtained by inserting the A-values in <span class="expr">A¬i</span> into the equation for S we introduced above.
    
<p>
We can now show that <span class="expr">s¬2=(3*s¬1+K)/2^a1</span>,
</p>

<pre class="code expr">     s¬1=3^[(n-1)]+3^[(n-2)]*2^[a1]+3^[(n-3)]*2^[(a1+a2)]+&hellip;+2^[(a1+a2+&hellip;+a(n-1))]
    3s¬1=3^n+3^[(n-1)]*2^[a1]+3^[(n-2)]*2^[(a1+a2)]+&hellip;+3*2^[(a1+a2+&hellip;+a(n-1))]
3s¬1+K=3^[(n-1)]*2^[a1]+3^[(n-2)]*2^[(a1+a2)]+&hellip;+3*2^[(a1+a2+&hellip;+a(n-1))]+2^[(a1+a2+&hellip;+an)]
       =2^[a1]*(3^[(n-1)]+3^[(n-2)]*2^[a2]+&hellip;+3*2^[(a2+&hellip;+a(n-1))]+2^[(a2+&hellip;+an)]
       =2^[a1]*s¬2

&Implies; (3s¬1+K)/2^[a1]=s¬2</pre>



<p>
so the set <span class="expr">[s¬1,&nbsp;s¬2,&nbsp;&hellip;]</span> represents an n&minus;cycle in <span class="expr">x&rarr;3x+K</span>.
</p><p>
  Clearly all systems of the form <span class="expr">x&rarr;3x+(2^m-3^n)</span> 
  will have cycles, with 'n' odd and 'm' even values.
</p><p>
  
  For all cases other than n&nbsp;=&nbsp;1, m&nbsp;=&nbsp;2 there will be
  multiple loops as we can construct multiple A-lists for every (m,n) pair. For m=2, n=1 the only viable set A is [[2]] and there is only one loop.
</p><p>
The set of 'K' values seems rather sparse, but all systems 3x+k (k is odd) must have at least one loop
(unless every seed diverges to infinity), so where do these come from?
</p>
<h3> Other values of k </h3>
<p>
If we start with the assumption that there is an s value, say <span class="expr">s¬1</span>, that has a common
factor with K, say 'f', then we can define
</p><p>  
  <pre class="code expr">t¬1=s¬1/f, k=K/f</pre>.
</p><p>  
    Then,
</p><p>  
    <pre class="code expr">s¬2=3*s¬1+K=3(f*t¬1)+(f*k)</pre>
</p><p>  
    Dividing through by 'f' gives
</p><p>  
    <pre class="code expr">t¬2=3*t¬1+k</pre>
</p><p>  
    So the set <span class="expr">[t¬1, t¬2, &hellip;] forms a cycle in 3x+k</span>.
</p><p>  
    How can we use this to identify the loops in k = 11? 

    I don't know of any solutions to <span class="expr">2^m-3^n=11</span>, so we need to search for a solution 
    where <span class="expr">2^m-3^n=11*x</span> and then see if any of the s-values generated are also multiples
    of x. Or we could take the more direct approach of calculating the orbits of values in <span class="expr">3x+11</span>
    and see where the loops are, and then work backwards to find the s-values.
    This second approach sounds easier.
</p><p>  
    Starting with 1, we immediately find the 2&minus;cycle [1,7],
</p><p>  
    <pre class="code expr">3*1+11=14,
14/2=7,
3*7+11=32,
32/2^5=1</pre>
</p><p>  
    The corresponding A-list is A = [1,5], so m=6 and n=2, this gives
</p><p>  
    <pre class="code expr">K=2^6-3^2=55 (5*11)
s¬1=3^1+2^1=5
s¬2=3^1+2^5=35</pre>

</p><p>
    So the loop [1,7] in 3x+11 corresponds to [5,35] in 3x+55.
</p>

<p> There is also a 1&minus;cycle, [11] in 3x+11, which in hindsight is rather obvious,
as <span class="expr">(3k+k)/2^2</span> always equals k.
This loop can be derived using multiplication from the [1, 4, 2, 1] cycle in 3x+1. Generally, if
<span class="expr">[s¬1,&nbsp;s¬2,&nbsp;&hellip;,&nbsp;s¬n]</span> defines a cycle in
<span class="expr">x&rarr;3x+K</span>, then
<span class="expr">[s¬1*f,&nbsp;s¬2*f,&nbsp;&hellip;,&nbsp;s¬n*f]</span> will form a cycle in
<span class="expr">x&#x2192;3x+K*f</span>.
</p><p>
  Interestingly, in 3x+11 there is a third loop [13, 25, 43, 35, 29, 49, 79, 31].
  Here A = [1, 1, 2, 2, 1, 1, 3, 3], so <span class="expr">m=14, n=8, giving
  K=2^[14]-3^8=9823=893*11</span>. If there are any other cycles
  in 3x+11 they will involve very big numbers, I've searched up to 10 million.
</p>
<h3> Multiples of k </h3>
<p>

    Generally to find cycles in 3x+k, when we can't express k in the form <span class="expr">k=2^m-3^n</span>, we need to find a value of
    <span class="expr">2^m-3^n</span> that is a multiple of k. To do this we separate out <span class="expr">2^m and 2^n</span> and look at
    the remainders when we divide them by k. Below we show the results for <span class="expr">k=11</span>:
    
</p><p>
    <pre class="code" id="result1"> &nbsp; </pre>
</p><p>
    You can see the results for other k values by entering the value into the box and clicking the "Show Remainders" button.
</p><p>
    <input id="mod_table" value="11"> <button onClick="MakeRemainderTable(mod_table, result1, result2);">Show Remainders</button>
</p><p>

    If <span class="expr">2^m mod k=3^n mod k then 2^m-3^n</span> will be a multiple of k. The following table shows the
    results for the number you chose above.
    
</p><p id="result2">
</p><p>
    
    The squares coloured in white are the pairs where this is true. If you chose a prime number
    then the pattern in the table will repeat indefinitely, so for 11, as well as the 5 (m,n) pairs (0,0), (2,4), (4,3), (6,2) and (8,1)
    there are an infinite number of other combinations achieved by adding (10j,&nbsp;5k), j and k are positive integers, to each of these.
    For instance adding (0,5), (10,0), (10,5), (20,0), (20,5) and (20,10) to (2,4) gives us these examples.        
         
</p><p>
<pre class="code expr">2^2-3^4=&minus;77=11*&minus;7
2^2-3^[4+5]=&minus;19679=11*&minus;1789
2^[2+10]-3^4=4015=11*365
2^[2+10]-3^[4+5]=&minus;15587=11*&minus;1417
2^[2+20]-3^4=4194223=11*381293
2^[2+20]-3^[4+5]=4174621=11*379511
2^[2+20]-3^[4+10]=&minus;588665=11*&minus;53515</pre>
</p><p>

If you chose a non-prime k, say 15, then the sequence of remainders may start with a few non repeating terms
before settling down into the cycle. In the table these numbers will be shown with a darker background.
</p>

<h3> Systematic Search </h3>


<p>
I ran a systematic search for loops in other systems for k values up to 199 and
seed values up to 100 million. You can see the results
<a href="diverge.html">here</a>.

In this search all the loop seeds were relatively small compared to k, the largest ratio
being 243.4 for s&nbsp;=&nbsp;7055 and k&nbsp;=&nbsp;29. The sequence of record holders is&hellip;

</p><p>

    <table>
        <tr>
          <td class="heading"> System </td>
          <td class="heading"> Seed </td>
          <td class="heading"> Size </td>
          <td class="heading"> Seed/K </td>
        </tr>

        <tr>
          <td class="code"> 3x+1 </td> <td class="number"> 1 </td> <td class="number"> 1 </td> <td class="number"> 1.0 </td>
        </tr>

        <tr>
          <td class="code"> 3x+5 </td> <td class="number"> 347 </td> <td class="number"> 17 </td> <td class="number"> 69.4 </td>
        </tr>

        <tr>
          <td class="code"> 3x+29 </td> <td class="number"> 7055 </td> <td class="number">41</td> <td class="number">243.3</td>
        </tr>

    </table>
</p>

<p>
This would be an interesting search to continue, but it is rather expensive in computer time.
The absense of medium size loop seeds in this search doesn't rule out their existance but it does suggest that
loops become scarcer as the range of numbers searched gets higher.
</p>

</div>


<!-- Other pages -->

<div class="float w10 box in2" style="overflow: auto;">
    
<h2><a name="others">Other 3x+1 Pages</a></h2>
    <p>
    
    <table cellpadding="4" cellspacing="0" width="500">
      <tr>
        <td><a href="a_lists.html"><img border="0" src="images/icon.gif" width="97" height="97"></a></td>
        <td class="linkP"><strong>A-Lists</strong>: Explores the lists of A-Values described above, the
                loops they generate and the constraints they place on the locations of additional loops in 3x+1.</td>
      </tr>
      
      
      <tr>
        <td><a href="t3a47.html"><img border="0" src="images/icon.gif" width="97" height="97"></a></td>
        <td class="linkP"><strong>3x+47</strong>: 47 is <span class="expr">128-81 (2^7-3^4)</span>, so it should have some
                4&minus;cycles. It also has a 7 cycle and 16 cycle. Click the image for an illustration.</td>
      </tr>
      
      
      <tr>
        <td><a href="int_log32.html"><img border="0" src="images/icon.gif" width="97" height="97"></a></td>
        <td class="linkP"><strong class="expr">log(3)/log(2)</strong>: Looking for integer approximations to this expression. 
                The best candidates for finding loops are when <span class="expr">m/n is close to log(3)/log(2)</span>.</td>
      </tr>
      
      <tr>
        <td><a href="constraints.html"><img border="0" src="images/icon.gif" width="97" height="97"></a></td>
        <td class="linkP"><strong>Constraints on loop size</strong>: More ramblings on loop size.</td>
      </tr>
      
    </table>
    <p>
    
<!-- Generic links -->
    
    <h2>Elsewhere on this site</h2>
    <p>
          <iframe class="links" src="http://www.eddaardvark.co.uk/links.html" title="Other pages on this site"></iframe>
    </p>
      
</div>

<!-- Copyright -->

   <p class="small"> (c) John Whitehouse 2011 - 2022 <p> </td>


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-8112879-1"); pageTracker._trackPageview();
</script>

</body>
</html>


